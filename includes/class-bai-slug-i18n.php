<?php
if ( ! defined( 'ABSPATH' ) ) { exit; }

class BAI_Slug_I18n {
    public static function lang() {
        $opt = BAI_Slug_Settings::get_settings();
        $l = isset( $opt['ui_lang'] ) ? $opt['ui_lang'] : 'zh';
        return in_array( $l, [ 'zh', 'en' ], true ) ? $l : 'zh';
    }

    public static function t( $key ) {
        $zh = [
            'menu_root' => 'WP-AI-Slug',
            'menu_settings' => 'WP-AI-Slug 设置',
            'page_settings_title' => 'WP-AI-Slug 设置',
            'btn_save' => '保存设置',
            'btn_test' => '测试连通性',
            'btn_go_bulk' => '打开批量处理页',
            'guide_quickstart' => '快速上手',
            'guide_providers' => '模型与 API',
            'guide_glossary' => '术语表',
            'guide_bulk' => '异步批量',
            'guide_manual' => '手动编辑',
            'guide_logs' => '日志与排查',
            'guide_privacy' => '隐私与成本',
            'guide_oss' => '开源信息',
            'bulk_title' => '批量处理',
            'bulk_desc' => '按批次提交到队列，适合历史内容。建议优先使用默认过滤器跳过已处理项。',
            'bulk_notice' => '执行期间请保持本页打开；关闭或离开会暂停，可在稍后从进度位置继续。',
            'label_post_types' => '文章类型',
            'label_batch_size' => '批次大小',
            'label_filters' => '过滤条件',
            'filter_only_non_ascii' => '仅处理 slug 为空或包含非 ASCII 字符的内容',
            'filter_only_eq_sanitized' => '仅在 slug 等于标准化标题时替换',
            'filter_skip_user' => '跳过标记为“人工修改”的内容',
            'filter_skip_ai' => '跳过已标记为“AI 生成”的内容',
            'filter_skip_user' => '跳过已标记为“人工修改”的内容',
            'filter_skip_ai_terms' => '跳过已标记为“AI 生成”的术语',
            'desc_enabled_post_types' => '勾选后：(1) 新建/保存该类型时自动生成 slug；(2) 作为批量处理默认范围。',
            'desc_enabled_taxonomies' => '勾选后：(1) 新建该分类法条目时自动生成 slug；(2) 作为术语批量处理默认范围。',
            'btn_start' => '开始',
            'btn_stop' => '暂停',
            'btn_reset_cursor' => '重置总进度',
            'progress' => '已处理：%1$s；已扫描：%2$s',
            'cursor' => '当前总进度：',
            'manual_title' => '文章类处理',
            'manual_desc' => '默认按 ID 逆序（新到旧）。保存后会把来源标记为“人工修改”以避免覆盖。',
            'col_id' => 'ID',
            'col_title' => '标题',
            'col_slug' => 'Slug',
            'col_attr' => '属性',
            'col_actions' => '操作',
            'attr_ai' => 'AI 生成',
            'attr_user' => '人工修改',
            'btn_edit' => '编辑',
            'btn_done' => '完成',
            'saving' => '保存中...',
            'save_failed' => '保存失败',
            'network_error' => '网络错误',
            'applied' => '已应用',
            'rejected' => '已拒绝',
            'no_selection' => '未选择任何项',
            'applying' => '正在应用所选',
            'apply_done' => '应用完成',
            'failed' => '失败',
            'error_generic' => '操作失败',
            'generate' => '生成',
            'generate_done' => '已完成所选生成',
            'site_topic' => '网站核心主题',
            'prompt_template' => '提示词模板',
            'prompt_template_zh' => '中文网站生成英文 Slug',
            'prompt_template_en' => '英文网站生成英文 Slug',
            'prompt_template_custom' => '自定义提示词',
            'prompt_template_help' => '选择模板后会自动填充系统提示词；选择“自定义”可手动编辑。',
            'site_topic_help' => '描述网站主要领域，用于替换模板中的 [SITE_TOPIC] 占位符。',
            'vars_help_heading' => '可用变量说明',
            'vars_help_intro' => '你可以在下方的提示词中使用以下变量。插件在为每篇文章生成 slug 时，会自动将它们替换为真实内容。',
            'vars_help_site_topic' => '[SITE_TOPIC] - 你设定的网站核心主题。',
            'vars_help_title' => '[TITLE] - 文章标题。',
            'vars_help_industry' => '[INDUSTRY] - 优先使用分类(Categories)的第一个分类名；若无则使用任意分类法中的第一个术语名。',
            'vars_help_excerpt' => '[BODY_EXCERPT] - 智能提取的文章开篇内容。',
            'vars_help_post_type' => '[POST_TYPE] - 文章类型（post、page 等）。',
            'vars_help_max_length' => '[MAX_LENGTH] - Slug 最大长度限制（来自设置）。',
            'glossary_import_success' => '术语表已导入，共 %d 条。',
            'glossary_import_missing' => '请先选择要上传的 CSV 文件。',
            'glossary_import_failed' => '无法读取上传的 CSV 文件。',
            'glossary_import_invalid' => 'CSV 中未找到有效的术语条目。',
            'search_posts_placeholder' => '按标题或 slug 搜索',
            'search_terms_placeholder' => '按名称或 slug 搜索术语',
        ];

        $en = [
            'menu_root' => 'WP-AI-Slug',
            'menu_settings' => 'WP-AI-Slug Settings',
            'page_settings_title' => 'WP-AI-Slug Settings',
            'btn_save' => 'Save Settings',
            'btn_test' => 'Test Connectivity',
            'btn_go_bulk' => 'Open Bulk Processor',
            'guide_quickstart' => 'Quick Start',
            'guide_providers' => 'Models & API',
            'guide_glossary' => 'Glossary',
            'guide_bulk' => 'Async Bulk',
            'guide_manual' => 'Manual Edit',
            'guide_logs' => 'Logs & Troubleshooting',
            'guide_privacy' => 'Privacy & Costs',
            'guide_oss' => 'Open Source & License',
            'bulk_title' => 'Bulk Processor',
            'bulk_desc' => 'Process large archives in manageable batches. Default filters help skip finished items.',
            'bulk_notice' => 'Keep this page open while the queue runs; leaving pauses the job and it can resume from the saved progress.',
            'label_post_types' => 'Post Types',
            'label_batch_size' => 'Batch Size',
            'label_filters' => 'Filters',
            'filter_only_non_ascii' => 'Only when slug is empty or contains non-ASCII characters',
            'filter_only_eq_sanitized' => 'Replace only if slug equals sanitized title',
            'filter_skip_user' => 'Skip entries marked user-edited',
            'filter_skip_ai' => 'Skip entries marked AI-generated',
            'filter_skip_user' => 'Skip entries marked user-edited',
            'filter_skip_ai_terms' => 'Skip terms marked AI-generated',
            'desc_enabled_post_types' => 'Checked: (1) Auto-generate slugs on create/save; (2) Default scope for post bulk runs.',
            'desc_enabled_taxonomies' => 'Checked: (1) Auto-generate slugs for new terms; (2) Default scope for term bulk runs.',
            'btn_start' => 'Start',
            'btn_stop' => 'Pause',
            'btn_reset_cursor' => 'Reset Progress',
            'progress' => 'Processed: %1$s; Scanned: %2$s',
            'cursor' => 'Progress:',
            'manual_title' => 'Post Processing',
            'manual_desc' => 'Sorted by ID desc (newest first). Saving marks the source as user-edited to avoid overrides.',
            'col_id' => 'ID',
            'col_title' => 'Title',
            'col_slug' => 'Slug',
            'col_attr' => 'Attribute',
            'col_actions' => 'Actions',
            'attr_ai' => 'AI Generated',
            'attr_user' => 'User Edited',
            'btn_edit' => 'Edit',
            'btn_done' => 'Done',
            'saving' => 'Saving...',
            'save_failed' => 'Save failed',
            'network_error' => 'Network error',
            'applied' => 'Applied',
            'rejected' => 'Rejected',
            'no_selection' => 'No selection',
            'applying' => 'Applying selection',
            'apply_done' => 'Apply finished',
            'failed' => 'Failed',
            'error_generic' => 'Operation failed',
            'generate' => 'Generate',
            'generate_done' => 'Generation finished for all selected',
            'site_topic' => 'Site Core Topic',
            'prompt_template' => 'Prompt Template',
            'prompt_template_zh' => 'Chinese Site → English Slug',
            'prompt_template_en' => 'English Site → English Slug',
            'prompt_template_custom' => 'Custom Prompt',
            'prompt_template_help' => 'Pick a template to preload the prompt; choose Custom to edit manually.',
            'site_topic_help' => 'Used to replace the [SITE_TOPIC] placeholder in the template.',
            'vars_help_heading' => 'Available Variables',
            'vars_help_intro' => 'You can use the following placeholders in the prompt. They are replaced with real values when generating a slug for each post.',
            'vars_help_site_topic' => '[SITE_TOPIC] - Your site’s core topic.',
            'vars_help_title' => '[TITLE] - Post title.',
            'vars_help_industry' => '[INDUSTRY] - Prefer the first Category term; falls back to the first term of any taxonomy.',
            'vars_help_excerpt' => '[BODY_EXCERPT] - Smartly extracted opening of the post.',
            'vars_help_post_type' => '[POST_TYPE] - Post type (post, page, etc.).',
            'vars_help_max_length' => '[MAX_LENGTH] - Max slug length (from settings).',
            'glossary_import_success' => 'Glossary imported: %d entries.',
            'glossary_import_missing' => 'Please choose a CSV file to upload.',
            'glossary_import_failed' => 'Could not read the uploaded CSV file.',
            'glossary_import_invalid' => 'No valid glossary rows were found in the CSV.',
            'search_posts_placeholder' => 'Search by title or slug',
            'search_terms_placeholder' => 'Search terms by name or slug',
        ];

        $dict = self::lang() === 'en' ? $en : $zh;
        return isset( $dict[ $key ] ) ? $dict[ $key ] : $key;
    }
}

?>
